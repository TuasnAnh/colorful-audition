(this["webpackJsonpmodern-audition"]=this["webpackJsonpmodern-audition"]||[]).push([[0],{33:function(e,t,n){e.exports=n(70)},35:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(3),s=(n(35),n(2)),o=n(23),h=n.n(o),c=n(10),d=function(){var e={},t={};return{init:function(n,i){var a=i.width,r=(i.height,i.assets.auditionAtlas),s=r.findRegion("table",-1),o=a,h=o*s.height/s.width;e={tex:s,w:o,h:h};var c=r.findRegion("bg",-1),d=a,u=d*c.height/c.width;t={tex:c,w:d,h:u}},update:function(n,i,a){var r=i.boundaryY,s=a.batch,o=a.width,h=(a.height,a.camera);s.setProjection(h.combined),s.begin(),s.setColor(1,1,1,1),t.tex.draw(s,o/2-t.w/2,-t.h/30,t.w,t.h),e.tex.draw(s,o/2-e.w/2,r,e.w,e.h),s.end()}}},u=function(){var e,t,n,i,a=[],r=[],s={},o=1,h=.4;return{init:function(o,h){var c=h.width,d=h.height,u=h.assets,f=u.auditionAtlas,l=u.finishAtlas,p=f.findRegion("up",-1),g=f.findRegion("down",-1),w=f.findRegion("left",-1),m=f.findRegion("right",-1),x=f.findRegion("up-press",-1),v=f.findRegion("down-press",-1),y=f.findRegion("left-press",-1),b=f.findRegion("right-press",-1),_=f.findRegion("finish_press",-1);t=l.findRegion("finish_start_effect",-1),i=(n=c/8)*t.height/t.width;var P=c/4,R=P*_.height/_.width,S=c/5,j=S*p.height/p.width,k=.8*S,E=(c-(2*S+k))/2,O=3.95*d/5;e=_,s={x:E+S+k/2-P/2,y:O+j/2-R/2,width:P,height:R},a=[{unpress:w,press:y},{unpress:p,press:x},{unpress:m,press:b},{unpress:g,press:v}],r=[{x:E,y:O,width:S,height:j},{x:E+S/2+k/2,y:O-.8*j,width:S,height:j},{x:E+S+k,y:O,width:S,height:j},{x:E+S/2+k/2,y:O+.8*j,width:S,height:j}],o.buttonRect=r,o.finishRect=s},update:function(c,d,u){var f=u.batch,l=u.camera;u.width,u.height,u.whiteTex;f.setProjection(l.combined),f.begin(),f.setColor(1,1,1,1),d.finishedPhase&&!d.newPhase?(o=Math.max(.7,o-=2*c),h=Math.min(1,h+=4*c)):d.finishedPhase&&!d.newPhase||(o=Math.min(1,o+=2*c),h=Math.max(.4,h-=4*c)),d.finishedPhase&&(d.starEffect.scale1+=47*c/3,f.setColor(1,1,1,d.starEffect.opacity1),t.draw(f,s.x+s.width/2-n/2,s.y+s.height/2-i/2,n,i,n/2,i/2,0,d.starEffect.scale1,d.starEffect.scale1),f.setColor(1,1,1,1),d.starEffect.scale1>=4&&(d.starEffect.scale2+=47*c/3,f.setColor(1,1,1,d.starEffect.opacity2),t.draw(f,s.x+s.width/2-n/2,s.y+s.height/2-i/2,n,i,n/2,i/2,0,d.starEffect.scale2,d.starEffect.scale2),f.setColor(1,1,1,1)),d.starEffect.scale1=Math.min(6,d.starEffect.scale1),6===d.starEffect.scale1&&(d.starEffect.opacity1=Math.max(0,d.starEffect.opacity1-=5*c)),d.starEffect.scale2=Math.min(6,d.starEffect.scale2),6===d.starEffect.scale2&&(d.starEffect.opacity2=Math.max(0,d.starEffect.opacity2-=5*c)));for(var p=0;p<r.length;p++){(d.keyActivated[p]?a[p].press:a[p].unpress).draw(f,r[p].x,r[p].y,r[p].width,r[p].height,r[p].width/2,r[p].height/2,0,o,o)}e.draw(f,s.x,s.y,s.width,s.height,s.width/2,s.height/2,0,h,h),f.end()}}},f=function(e,t){return t[e]=!0},l=function(e,t){return t[e]=!1},p=function(e,t,n,i){if(e===t[n][i.currentCheckingNoteIndex].type)t[n][i.currentCheckingNoteIndex].activated=!0,i.zoomOutNoteIndexs.push(i.currentCheckingNoteIndex),i.currentCheckingNoteIndex+=1,i.currentCheckingNoteIndex===t[n].length&&(i.currentCheckingNoteIndex=t[n].length-1,i.finishedPhase=!0);else{i.currentCheckingNoteIndex=0;for(var a=0;a<t[n].length;a++)t[n][a].activated=!1}},g=function(){var e={},t=new s.a;return{init:function(n,i){i.canvas,i.camera,i.pixelRatio;var a=i.inputHandler,r=n.buttonRect,s=n.notes,o=n.finishRect;a.addEventListener("touchStart",(function(i,h,c){t.setVector(a.getTouchedWorldCoord());var d=function(e,t,n){for(var i=0;i<4;i++){var a=n[i];if(e>a.x&&e<a.x+a.width&&t>a.y&&t<a.y+a.height)return i}return-1}(t.x,t.y,r);if(d>-1&&!n.finishedPhase)e[c]=d,f(d,n.keyActivated),p(d,s,n.phaseIndex,n);else if(n.finishedPhase){1===function(e,t,n){return e>n.x&&e<n.x+n.width&&t>n.y&&t<n.y+n.height?1:0}(t.x,t.y,o)&&(n.canPassPhase?n.hit++:(n.miss++,n.anim[n.animIndex]=n.missAnim),n.hitFinishButton=!0)}})),a.addEventListener("touchEnd",(function(t){l(e[t],n.keyActivated)})),document.addEventListener("keydown",(function(e){65===e.which?n.finishedPhase||(f(0,n.keyActivated),p(0,s,n.phaseIndex,n)):87===e.which?n.finishedPhase||(f(1,n.keyActivated),p(1,s,n.phaseIndex,n)):68===e.which?n.finishedPhase||(f(2,n.keyActivated),p(2,s,n.phaseIndex,n)):83===e.which&&(n.finishedPhase||(f(3,n.keyActivated),p(3,s,n.phaseIndex,n))),n.finishedPhase&&32===e.which&&(n.canPassPhase?n.hit++:(n.miss++,n.anim[n.animIndex]=n.missAnim),n.hitFinishButton=!0)})),document.addEventListener("keyup",(function(e){65===e.which?l(0,n.keyActivated):87===e.which?l(1,n.keyActivated):68===e.which?l(2,n.keyActivated):83===e.which&&l(3,n.keyActivated)}))},update:function(){}}},w=function(){var e=[];return{init:function(t,n){var i=n.assets.auditionAtlas,a=i.findRegion("down-btn",-1),r=i.findRegion("up-btn",-1),s=i.findRegion("left-btn",-1),o=i.findRegion("right-btn",-1),h=i.findRegion("down-btn-gray",-1),c=i.findRegion("up-btn-gray",-1),d=i.findRegion("left-btn-gray",-1),u=i.findRegion("right-btn-gray",-1);e=[{active:s,passive:d},{active:r,passive:c},{active:o,passive:u},{active:a,passive:h}]},update:function(t,n,i){for(var a=n.notes,r=n.noteInfos,s=(n.currentCheckingNoteIndex,n.phaseIndex),o=n.zoomOutNoteIndexs,h=n.zoomOutNoteInfos,c=n.newPhase,d=i.batch,u=(i.width,i.height,i.camera),f=r[s],l=a[s],p=0;p<o.length;p++){var g=o[p];h.push({tex:e[l[g].type].passive,scale:2,postion:f[g]}),o.splice(p,1)}if(d.setProjection(u.combined),d.begin(),d.setColor(1,1,1,1),!c)for(var w=0;w<f.length;w++){var m=f[w];if((!0===l[w].activated?e[l[w].type].active:e[l[w].type].passive).draw(d,m.x,m.y,m.width,m.height),h[w]){h[w].scale-=4*t;var x=h[w],v=x.tex,y=x.postion;d.setColor(1,1,1,.5),v.draw(d,y.x,y.y,y.width,y.height,y.width/2,y.height/2,0,h[w].scale,h[w].scale),d.setColor(1,1,1,1),h[w].scale<=1.1&&h.splice(w,1)}}d.end()}}},m=function(){var e,t,n,i,a,r,s,o,h,c,d,u,f,l,p,g,w={},m={},x={};return{init:function(a,v){var y=a.boundaryY,b=v.assets,_=v.width,P=v.height,R=b.auditionAtlas,S=b.finishAtlas;e=R.findRegion("finish_bar",-1),n=R.findRegion("finish_metter",-1),t=R.findRegion("finish_mark",-1),i=S.findRegion("finsh_mark_effect",-1),d=S.findRegion("cool",-1),u=S.findRegion("great",-1),f=S.findRegion("perfect",-1),l=S.findRegion("miss",-1),p=[f,u,d,l];var j=P/25,k=j*d.width/d.height,E=P/25,O=E*u.width/u.height,I=P/25,C=I*f.width/f.height,A=P/25,M=A*l.width/l.height;g=[{width:C,height:I},{width:O,height:E},{width:k,height:j},{width:M,height:A}];var T=(r=8.8*_/9)*e.height/e.width,N=(_-r)/2,z=(o=r/30)*t.height/t.width;i=S.findRegion("finsh_mark_effect",-1),c=(h=o)*i.height/i.width;var U=(s=(r-o)/4)*n.height/n.width;w={x:N,y:y,width:r,height:T},m={x:N+.575*(r-o),y:y+T/2-U,width:s,height:U},x={y:y+T/2-z/2,width:o,height:z}},update:function(d,u,f){var l=f.width,v=f.height,y=f.batch,b=f.camera,_=u.stateTime,P=u.realTimeDurationSet,R=u.durationEachPhase;if(x.x=(l-r)/2+29*r/30-(P-_)/R*(29*r/30),a=s*R/(r-o)-o*R/(r-o),P-_<R-.575*R&&P-_>R-.575*R-a&&u.finishedPhase?u.canPassPhase=!0:u.canPassPhase=!1,y.setProjection(b.combined),y.begin(),e.draw(y,w.x,w.y,w.width,w.height),n.draw(y,m.x,m.y,m.width,m.height),u.hitFinishButton){var S=function(e,t,n,i,a,r,s){var o,h=n-.575*n-i/2,c=i/6;return e-t<h+c&&e-t>h-c?("perfect",o={tex:r[0],infos:s[0]}):e-t<h-c&&e-t>h-2*c||e-t<h+2*c&&e-t>h+c?("great",o={tex:r[1],infos:s[1]}):e-t<h-2*c&&e-t>h-3*c||e-t<h+3*c&&e-t>h+2*c?("cool",o={tex:r[2],infos:s[2]}):("miss",o={tex:r[3],infos:s[3]}),o}(P,_,R,a,0,p,g);u.textPopUp.startY=Math.max(1.1*v/3,u.textPopUp.startY-=d*v/3),u.textPopUp.scale=Math.min(1,u.textPopUp.scale+=5*d),u.textPopUp.startY===1.1*v/3&&(u.textPopUp.opacity=Math.max(0,u.textPopUp.opacity-=5*d)),y.setColor(1,1,1,u.textPopUp.opacity),S.tex.draw(y,l/2-S.infos.width/2,u.textPopUp.startY,S.infos.width,S.infos.height,S.infos.width/2,S.infos.height/2,0,u.textPopUp.scale,u.textPopUp.scale)}u.hitFinishButton?(u.finishMarkEffect.scale=Math.min(2.3,u.finishMarkEffect.scale+=10*d),2.3===u.finishMarkEffect.scale&&(u.finishMarkEffect.opacity=Math.max(0,u.finishMarkEffect.opacity-=5*d)),y.setColor(1,1,1,u.finishMarkEffect.opacity),i.draw(y,x.x+x.width/2-h/2+x.width/2,x.y+x.height/2-c/2,h,c,h/2,c/2,0,u.finishMarkEffect.scale,u.finishMarkEffect.scale),y.setColor(1,1,1,1),0===u.finishMarkEffect.opacity&&(u.newPhase=!0)):(u.finishMarkEffect={scale:1,opacity:1},t.draw(y,x.x+x.width/2,x.y,x.width,x.height)),y.end()}}},x=n(4),v=n(0),y=n(9),b=function(){var e,t,n,i,a,r={buom_bay_right:{x:5,y:-3},xoa_tay:{x:-5,y:-5},buom_bay_left:{x:3,y:-3},choang_nhau:{x:5,y:0},tinh_ban:{x:5,y:2},ca_sau:{x:4,y:3}};return{init:function(t,n){var r=n.width,o=n.height,h=n.canvas,c=n.pixelRatio,d=n.spriter,u=Object(s.i)(h,c),f=Object(x.a)(u,2),l=f[0],p=f[1];e=function(e,t,n,i){var a=v.a.create(),r=v.a.create(),s=v.a.create(),o=v.a.create(),h=[0,0],c=[0,0,0],d=[0,0,1],u=[0,0,0],f=[0,1,0],l=function(){v.a.ortho(a,-e/2,e/2,-t/2,t/2,0,1);var n=h[0],i=h[1];d[0]=u[0]=n,d[1]=u[1]=i,v.a.identity(r),v.a.lookAt(o,d,u,f),v.a.mul(r,r,o),v.a.mul(a,a,r),v.a.invert(s,a)};return l(),{combined:a,setMatrix:function(e){v.a.copy(a,e),v.a.invert(s,a)},setYUp:function(e){f[1]=e?-1:1,l()},setPosition:function(e,t){h[0]=e,h[1]=t,l()},unprojectVector2:function(e,t){c[0]=t.x,c[1]=t.y,c[2]=0,Object(y.a)(c,c,s,0,0,n,i),e.set(c[0],c[1])},resize:function(n,i){e=n,t=i,l()}}}(r,o,l,p),i=r,a=a=r/d.getAspect(),d.setEntity("hands")},update:function(s,o,h){var c=h.spriter,d=h.batch,u=h.width,f=h.height;h.pixelRatio;d.setProjection(e.combined),d.begin(),c.setAnim(o.anim[o.animIndex]),c.update(1e3*s),t=0,n=0;var l=r[c.getAnim()];l&&(t=l.x,n=l.y),c.draw(d,0+t,f/2-a/2+n,i,a,u/f),d.end()}}},_=function(){var e={};return{init:function(t,n){var i=n.assets,a=n.width,r=i.curtain,s=a,o=s*r.height/r.width;e={tex:r,w:s,h:o}},update:function(t,n,i){var a=i.camera,r=i.batch;r.setProjection(a.combined),r.begin(),r.setColor(1,1,1,1),Object(s.f)(r,e.tex,0,0,e.w,e.h),r.end()}}},P=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=e.x*n,a=e.y*n,r=t[0],s=t[0]+t[2],o=t[1],h=t[1]+t[3];return!(i<r||i>s||a<o||a>h)},R=function(e){var t=function(){var t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,j(e);case 3:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n=e.batch,i=e.canvas,o=e.width,h=e.height,c=e.camera,d=e.viewport,u=e.assets,f=Object(s.e)(i,d),l=u.auditionAtlas,p=u.startEndAtlas,g=l.findRegion("table",-1),w=o,m=w*g.height/g.width,x=l.findRegion("bg",-1),v=o,y=v*x.height/x.width,b=u.curtain,_=o,R=_*b.height/b.width,S=p.findRegion("restart_button",-1),k=p.findRegion("quote",-1),E=p.findRegion("your_score",-1),O=p.findRegion("percentage",-1),I=o/4.5,C=I*S.height/S.width,A=o/2-I/2,M=2.3*h/3,T=[A,M,I,C],N=.95*o,z=N*k.height/k.width,U=o/1.8,V=U*E.height/E.width,B=p.findRegion("0_end",-1),F=p.findRegion("1_end",-1),Y=p.findRegion("2_end",-1),D=p.findRegion("3_end",-1),J=p.findRegion("4_end",-1),L=p.findRegion("5_end",-1),W=p.findRegion("6_end",-1),X=p.findRegion("7_end",-1),H=p.findRegion("8_end",-1),q=p.findRegion("9_end",-1),$=h/8,Z=[{tex:B,width:$*B.width/B.height},{tex:F,width:$*F.width/F.height},{tex:Y,width:$*Y.width/Y.height},{tex:D,width:$*D.width/D.height},{tex:J,width:$*J.width/J.height},{tex:L,width:$*L.width/L.height},{tex:W,width:$*W.width/W.height},{tex:X,width:$*X.width/X.height},{tex:H,width:$*H.width/H.height},{tex:q,width:$*q.width/q.height}],G={tex:O,width:$*O.width/O.height},K=function(e,t,n,i){for(var a=0,r=[],s=0;s<e.length;s++)a+=t[s].width;for(var o=n/2-(a+=i.width)/2,h=0,c=0;c<e.length;c++){h+=t[c-1]?t[c-1].width:0,r.push({tex:t[e[c]].tex,x:o+h,width:t[c].width})}return h+=t[t.length-1].width,r.push({tex:i.tex,x:o+h,width:i.width}),r}(function(e){for(var t=[],n=0;n<e.length;n++){var i=e.charAt(n);t.push(parseInt(i))}return t}(e.completePercentage.toString()),Z,o,G);f.addEventListener("touchStart",(function(n,i){var a=f.getTouchedWorldCoord();P({x:a.x,y:a.y},T)&&(e.completePercentage=0,t())}));return{update:function(e){n.setProjection(c.combined),n.begin(),n.setColor(1,1,1,1),x.draw(n,o/2-v/2,-y/30,v,y),g.draw(n,o/2-w/2,h/2-h/20,w,m),Object(s.f)(n,b,0,0,_,R),S.draw(n,A,M,I,C),k.draw(n,o/2-N/2,h/2,N,z),E.draw(n,o/2-U/2,h/4,U,V);for(var t=0;t<K.length;t++)K[t].tex.draw(n,K[t].x,h/3,K[t].width,$);n.end()},destroy:function(){f.cleanup()}}},S=function(e){for(var t=e.canvas,n=e.width,i=e.height,o=e.gl,h=e.batch,f=e.whiteTex,l=e.camera,p=e.pixelRatio,x=e.assets,v=e.spriter,y=e.viewport,P=e.sound,S=Object(s.e)(t,y),j="0,4,4,3\n  8,5,7,4\n  20,4,0,4\n  24,6,0,6\n  30,4,0,6\n  34,5,0,5\n  39,4,0,5\n  43,4,2,6\n  49,5,0,5\n  54,5,0,6".split("\n"),k=[],E=0;E<j.length;E++){var O=j[E].split(",").map((function(e){return e.trim()}));k.push({start:parseInt(O[0]),duration:parseInt(O[1]),restTime:parseInt(O[2]),nodes:parseInt(O[3])})}P.play();for(var I=[],C=0;C<k.length;C++)I.push(k[C].nodes);for(var A=[],M=0,T=I;M<T.length;M++){for(var N=T[M],z=[],U=0;U<N;U++)z.push({type:Math.floor(4*Math.random()),activated:!1});A.push(z)}for(var V=n/7.5,B=n/15,F=i/2+i/30,Y=[],D=0;D<A.length;D++){for(var J=[],L=0,W=0,X=0,H=0;H<A[D].length;H++){var q=0;H<=3?(X=A[D].length,W=(n-B*(Math.min(4,X)-1)-V*Math.min(4,X))/2,L=F,q=H):(W=(n-B*((X=A[D].length-4)-1)-V*X)/2,L=F+i/13,q=Math.abs(4-H)),J.push({x:W+(V+B)*q,y:L,width:V,height:V})}Y.push(J)}var $=["buom_bay_right","xoa_tay","buom_bay_left","choang_nhau","tinh_ban","ca_sau","buom_bay_right","xoa_tay","buom_bay_left","choang_nhau"],Z={hit:0,miss:0,anim:$,missAnim:"bam_sai",animIndex:-1,stateTime:0,keyActivated:[],boundaryY:i/2-i/20,gameOver:!1,buttonInfos:null,durationBarInfos:{duration:4,x:(n-4*n/5)/2,y:3*i/4,width:4*n/5,height:i/10},notes:A,noteInfos:Y,currentCheckingNoteIndex:0,phaseIndex:-1,durationEachPhase:4,realTimeDurationSet:4,newPhase:!0,canPassPhase:!1,finishedPhase:!1,zoomOutNoteIndexs:[],zoomOutNoteInfos:[],hitFinishButton:!1,starEffect:{scale1:1,opacity1:1,scale2:1,opacity2:1},finishMarkEffect:{scale:1,opacity:1},textPopUp:{opacity:1,scale:.5,startY:1.3*i/3}},G=function(e,t){var n=[],i=[];return{addSystem:function(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.init&&a.init(e,t),r?i.push(a):n.push(a)},update:function(a){var r,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object(c.a)(n);try{for(o.s();!(r=o.n()).done;){var h=r.value;h.update(a,e,t)}}catch(l){o.e(l)}finally{o.f()}if(s){var d,u=Object(c.a)(i);try{for(u.s();!(d=u.n()).done;){var f=d.value;f.update(a,e,t)}}catch(l){u.e(l)}finally{u.f()}}}}}(Z,{canvas:t,width:n,height:i,gl:o,batch:h,whiteTex:f,camera:l,pixelRatio:p,assets:x,spriter:v,inputHandler:S});G.addSystem(d()),G.addSystem(b()),G.addSystem(_()),G.addSystem(u()),G.addSystem(g()),G.addSystem(m()),G.addSystem(w());var K=function(){var t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,R(e);case 3:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Q=0,ee=0,te=!0;return{update:function(t){Q+=t,Z.hitFinishButton||(Z.stateTime+=t),te&&(Q=k[ee].duration+k[ee].restTime+1),Q>k[ee].duration&&(Z.newPhase||(Z.anim[Z.animIndex]=Z.missAnim),Z.newPhase=!0),Q>k[ee].duration+k[ee].restTime&&(te&&(te=!1,ee=-1),Q=0,ee+=1,Z.animIndex+=1,Z.animIndex===$.length&&(e.completePercentage=Math.floor(Z.hit/$.length*100),K()),Z.starEffect={scale1:1,scale2:1,opacity1:1,opacity2:1},Z.textPopUp={opacity:1,scale:.5,startY:1.3*i/3},Z.hitFinishButton=!1,Z.newPhase=!1,Z.finishedPhase=!1,Z.canPassPhase=!1,Z.zoomOutNoteIndexs.length=0,Z.zoomOutNoteInfos.length=0,Z.animIndex<$.length&&(Z.durationEachPhase=k[Z.animIndex].duration),Z.realTimeDurationSet=Z.stateTime+Z.durationEachPhase,Z.currentCheckingNoteIndex=0,Z.phaseIndex+=1,Z.phaseIndex=Z.phaseIndex>I.length-1?I.length-1:Z.phaseIndex),h.setProjection(l.combined),G.update(t)},destroy:function(){S.cleanup()}}},j=function(e){var t=e.batch,n=e.canvas,i=e.width,o=e.height,h=(e.whiteTex,e.camera),c=e.viewport,d=e.assets,u=Object(s.e)(n,c),f=d.auditionAtlas,l=d.startEndAtlas,p=f.findRegion("table",-1),g=i,w=g*p.height/p.width,m=f.findRegion("bg",-1),x=i,v=x*m.height/m.width,y=d.curtain,b=i,_=b*y.height/y.width,R=l.findRegion("number1_start",-1),j=l.findRegion("number2_Start",-1),k=l.findRegion("number3_start",-1),E=l.findRegion("start_button"),O=i/2,I=O*E.height/E.width,C=[i/2-O/2,2.3*o/3,O,I],A=o/8,M=A*R.width/R.height,T=o/8,N=T*j.width/j.height,z=o/8,U=A*k.width/k.height,V=!1,B=0,F=function(){var t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,S(e);case 3:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();u.addEventListener("touchStart",(function(e,t){var n=u.getTouchedWorldCoord();P({x:n.x,y:n.y},C)&&(V=!0)}));return{update:function(e){var n,a;(h.setPosition(0,0),t.setProjection(h.combined),t.begin(),t.setColor(1,1,1,1),m.draw(t,i/2-x/2,-v/30,x,v),p.draw(t,i/2-g/2,o/2-o/20,g,w),Object(s.f)(t,y,0,0,b,_),E.draw(t,C[0],C[1],C[2],C[3]),V&&B<3)&&(B<1?(n=k,a=[U,z]):B>1&&B<2?(n=j,a=[N,T]):B>2&&B<3&&(n=R,a=[M,A]),B+=e,n.draw(t,i/2-a[0]/2,1*o/5,a[0],a[1]));B>=3&&F(),t.end()},destroy:function(){u.cleanup()}}},k=function(e,t){var n={toObj:function(e){var t={};if(1===e.nodeType){if(e.attributes.length)for(var i=0;i<e.attributes.length;i++)t["@"+e.attributes[i].nodeName]=(e.attributes[i].nodeValue||"").toString();if(e.firstChild){for(var a=0,r=0,s=!1,o=e.firstChild;o;o=o.nextSibling)1===o.nodeType?s=!0:3===o.nodeType&&o.nodeValue.match(/[^ \f\n\r\t\v]/)?a++:4===o.nodeType&&r++;if(s)if(a<2&&r<2){n.removeWhite(e);for(var h=e.firstChild;h;h=h.nextSibling)3===h.nodeType?t["#text"]=n.escape(h.nodeValue):4===h.nodeType?t["#cdata"]=n.escape(h.nodeValue):t[h.nodeName]?t[h.nodeName]instanceof Array?t[h.nodeName][t[h.nodeName].length]=n.toObj(h):t[h.nodeName]=[t[h.nodeName],n.toObj(h)]:t[h.nodeName]=n.toObj(h)}else e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(a)e.attributes.length?t["#text"]=n.escape(n.innerXml(e)):t=n.escape(n.innerXml(e));else if(r)if(r>1)t=n.escape(n.innerXml(e));else for(var c=e.firstChild;c;c=c.nextSibling)t["#cdata"]=n.escape(c.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9===e.nodeType?t=n.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,i){var a=t?'"'+t+'"':"";if(e instanceof Array){for(var r=0,s=e.length;r<s;r++)e[r]=n.toJson(e[r],"",i+"\t");a+=(t?":[":"[")+(e.length>1?"\n"+i+"\t"+e.join(",\n"+i+"\t")+"\n"+i:e.join(""))+"]"}else if(null==e)a+=(t&&":")+"null";else if("object"==typeof e){var o=[];for(var h in e)o[o.length]=n.toJson(e[h],h,i+"\t");a+=(t?":{":"{")+(o.length>1?"\n"+i+"\t"+o.join(",\n"+i+"\t")+"\n"+i:o.join(""))+"}"}else a+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return a},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var n=function e(t){var n="";if(1===t.nodeType){n+="<"+t.nodeName;for(var i=0;i<t.attributes.length;i++)n+=" "+t.attributes[i].nodeName+'="'+(t.attributes[i].nodeValue||"").toString()+'"';if(t.firstChild){n+=">";for(var a=t.firstChild;a;a=a.nextSibling)n+=e(a);n+="</"+t.nodeName+">"}else n+="/>"}else 3===t.nodeType?n+=t.nodeValue:4===t.nodeType&&(n+="<![CDATA["+t.nodeValue+"]]>");return n},i=e.firstChild;i;i=i.nextSibling)t+=n(i);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3===t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var i=t.nextSibling;e.removeChild(t),t=i}else 1===t.nodeType?(n.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9===e.nodeType&&(e=e.documentElement);var i=n.toJson(n.toObj(n.removeWhite(e)),e.nodeName,"\t");return"{\n"+t+(t?i.replace(/\t/g,t):i.replace(/\t|\n/g,""))+"\n}"},E=n(16),O=function(){var e=Object(r.a)(a.a.mark((function e(t){var n,i,r,s,o,h,c,d,u,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={},i=null,e.next=4,fetch(t).then((function(e){return e.text()}));case 4:return s=e.sent,null!==t.match(/.scml$/i)?(o=new DOMParser,h=s.replace(/&quot;/g,'"'),c=o.parseFromString(h,"text/xml"),d=(d=k(c,"\t")).replace(/"@(.*)":/g,'"$1":'),u=JSON.parse(d),r=u.spriter_data):r=JSON.parse(s),(i=(new E.Data).load(r)).folder_array.forEach((function(e,t){n[t]={},e.file_array.forEach((function(t,i){n[e.id][i]=t.name}))})),f=new E.Pose(i),e.abrupt("return",{regionNames:n,pose:f,data:i,rawData:r});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=n(7),C=n(5),A=function(){function e(t,n,i,a,r,s,o,h,c,d){Object(I.a)(this,e),c&&d||(c=1/t.width,d=1/t.height);var u=n*c,f=i*d,l=(n+a)*c,p=(i+r)*d;for(var g in this.rotated=!1,this.texture=t,this.x=n,this.y=i,this.originX=s,this.originY=o,this.width=a,this.height=r,this.u=u,this.v=f,this.u2=l,this.v2=p,h)this[g]=h[g]}return Object(C.a)(e,null,[{key:"splitTexture",value:function(t,n,i){for(var a=t.width/n,r=t.height/i,s=[],o=0;o<n;o++)for(var h=0;h<i;h++)s.push(new e(t,o*a,h*r,a,r,{}));return s}}]),Object(C.a)(e,[{key:"draw",value:function(e,t,n,i,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;e.draw(this.texture,t,n,i,a,this.rotated,r,s,o,h,c,this.u,this.v,this.u2,this.v2)}}]),e}();function M(e,t){for(var n=e.split("/"),i=t.split("/"),a=[],r=0,s=n.length;r<s;r++)if(".."===n[r])a.pop();else{if("."===n[r])continue;a.push(n[r])}for(var o=0,h=i.length;o<h;o++)if(".."===i[o])a.pop();else{if("."===i[o])continue;a.push(i[o])}return a.join("/")}var T=function(){var e=Object(r.a)(a.a.mark((function e(t,n,i,r){var o,h,c,d,u,f,l,p,g,w,m,x,v,y,b,_,P,R,S,j,k,E,O,I,C,T,N;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n).then((function(e){return e.text()}));case 2:for(o=e.sent,h=[],c=[],d=JSON.parse(o),u=d.meta,f=Object.getOwnPropertyNames(d.frames),l=Object.keys(d.frames).map((function(e){return d.frames[e]})),p=M(n,"../".concat(u.image)),g=0;g<l.length;g++)w=l[g],m=w.frame.w,x=w.frame.h,v={x:w.frame.x,y:w.frame.y,w:w.frame.w,h:w.frame.h,rotate:w.rotated?1:0,offset_x:w.spriteSourceSize&&w.spriteSourceSize.x||0,offset_y:w.spriteSourceSize&&w.spriteSourceSize.y||0,original_w:w.sourceSize&&w.sourceSize.w||m,original_h:w.sourceSize&&w.sourceSize.h||x},c.push(v),y={id:g,name:f[g],frame:w.frame,rotated:"true"===w.rotated,sourceSize:w.sourceSize,spriteSourceSize:w.spriteSourceSize,trimmed:w.trimmed,app:u.app,format:u.format,main_texture:u.image,scale:u.scale,size:u.size,version:u.version,site:v,meta:u},h.push(y);return e.next=13,Object(s.h)(t,p,i);case 13:for(b=e.sent,_=0,P=h;_<P.length;_++)R=P[_],S=R.frame.x,j=R.frame.y,k=R.rotated?R.frame.h:R.frame.w,E=R.rotated?R.frame.w:R.frame.h,O=R.rotated?R.sourceSize.h:R.sourceSize.w,I=R.rotated?R.sourceSize.w:R.sourceSize.h,C=R,T=1/R.size.w,N=1/R.size.h,r.push(new A(b,S,j,k,E,O,I,C,T,N));return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})));return function(t,n,i,a){return e.apply(this,arguments)}}(),N=function(){var e=Object(r.a)(a.a.mark((function e(t,n,i){var r,s,o,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],!Array.isArray(n)){e.next=22;break}s=Object(c.a)(n),e.prev=3,s.s();case 5:if((o=s.n()).done){e.next=12;break}return h=o.value,e.next=9,T(t,h,i,r);case 9:r=e.sent;case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),s.e(e.t0);case 17:return e.prev=17,s.f(),e.finish(17);case 20:e.next=25;break;case 22:return e.next=24,T(t,n,i,r);case 24:r=e.sent;case 25:return e.abrupt("return",{getRegions:function(){return r},findRegion:function(e){for(var t=0;t<r.length;t++)if(r[t].name===e)return r[t]}});case 26:case"end":return e.stop()}}),e,null,[[3,14,17,20]])})));return function(t,n,i){return e.apply(this,arguments)}}(),z=n(24),U=n.n(z);function V(e,t){for(var n=e.split("/"),i=t.split("/"),a=[],r=0,s=n.length;r<s;r++)".."===n[r]?a.pop():a.push(n[r]);for(var o=0,h=i.length;o<h;o++)if(".."===i[o])a.pop();else{if("."===i[o])continue;a.push(i[o])}return a.join("/")}var B=function(){var e=Object(r.a)(a.a.mark((function e(t,n,i){var r,s,o,h,c,d,u,f,l,p,g,w,m,x,y,b,_,P,R,S,j,k,E,I,C,A,M,T;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(n);case 2:return r=e.sent,s=r.regionNames,o=r.pose,h=r.data,c=r.rawData,d=c.atlas.i,u=v.a.create(),f=new Float32Array(20),l=[],p=[],g=[],w=[],m=[],x=[],y=[],b=[],e.next=20,N(t,d.map((function(e){return V(n,"../".concat(e.name))})));case 20:return _=e.sent,R=function(e,t,n,i,a,r){e.length=0,e.push(t,n,i,a,r)},S=function(e,t,n,i,a,r){e.rotated?(R(l,t.x-e.height/2,t.y-e.width/2,r,e.u,e.v),R(p,t.x+e.height/2,t.y-e.width/2,r,e.u,e.v2),R(g,t.x+e.height/2,t.y+e.width/2,r,e.u2,e.v2),R(w,t.x-e.height/2,t.y+e.width/2,r,e.u2,e.v)):(R(l,t.x-e.width/2,t.y-e.height/2,r,e.u,e.v2),R(p,t.x+e.width/2,t.y-e.height/2,r,e.u2,e.v2),R(g,t.x+e.width/2,t.y+e.height/2,r,e.u2,e.v),R(w,t.x-e.width/2,t.y+e.height/2,r,e.u,e.v)),v.a.identity(u),v.a.translate(u,u,[t.x,t.y,0]),v.a.rotateZ(u,u,n.rad),v.a.scale(u,u,[i.x,i.y,1]),v.a.translate(u,u,[-t.x,-t.y,0]),R(m,l[0],l[1],0),R(x,p[0],p[1],0),R(y,g[0],g[1],0),R(b,w[0],w[1],0),v.b.transformMat4(m,m,u),v.b.transformMat4(x,x,u),v.b.transformMat4(y,y,u),v.b.transformMat4(b,b,u),a&&(m=a.transform(m),x=a.transform(x),y=a.transform(y),b=a.transform(b)),f[0]=m[0],f[1]=m[1],f[2]=l[2],f[3]=l[3],f[4]=l[4],f[5]=x[0],f[6]=x[1],f[7]=p[2],f[8]=p[3],f[9]=p[4],f[10]=y[0],f[11]=y[1],f[12]=g[2],f[13]=g[3],f[14]=g[4],f[15]=b[0],f[16]=b[1],f[17]=w[2],f[18]=w[3],f[19]=w[4]},k=[[0,0],[0,0],[0,0]],E=[[0,0],[0,0],[0,0]],e.abrupt("return",{getAnim:function(){return o.getAnim()},getInfos:function(){return{regionNames:s,pose:o,data:h,rawData:c}},getAspect:function(){return P?P.w/P.h:1},update:function(e){o.update(e),o.strike()},setEntity:function(e){o.setEntity(e);var t=o.data.entity_map[e];P=t.obj_info_map[i],T=null},setAnim:function(e){o.setAnim(e),T=null},draw:function(e,t,n,a,r){if(!j){var h=(j=o.object_array.find((function(e){return e.name===i}))).world_space.position.x,c=j.world_space.position.y,d=P.w*j.world_space.scale.x,u=P.h*j.world_space.scale.y;R(k[0],h-d/2,c-u/2),R(k[1],h+d/2,c-u/2),R(k[2],h-d/2,c+u/2)}T&&t===I&&n===C&&a===A&&r===M||(R(E[0],t-a/2,n-r/2),R(E[1],t+a/2,n-r/2),R(E[2],t-a/2,n+r/2),I=t,C=n,A=a,M=r,T=U.a.estimate("TS",k,E)),o.object_array.forEach((function(t){if("sprite"===t.type){var n=t.world_space,i=n.position,a=n.rotation,r=n.scale;if(s[t.folder_index]&&s[t.folder_index][t.file_index]){var o=_.findRegion(s[t.folder_index][t.file_index]);o&&(S(o,i,a,r,T,e.color),e.drawVertices(o.texture,f,0))}}}))}});case 26:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),F=n(25);(function(){var e=Object(r.a)(a.a.mark((function e(){var t,n,i,r,o,c,d,u,f,l,p,g,w,m,x,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.getElementById("main"),n=window.devicePixelRatio,47,100,i=Object(s.d)(t,47,100),r=i.getContext(),o=i.getCamera(),c=Object(s.b)(r),d=h()(r),u=new F.Howl({src:["ghen_covy.mp3"]}),f={completePercentage:0,viewport:i,canvas:t,width:47,height:100,gl:r,batch:c,whiteTex:d,camera:o,pixelRatio:n,sound:u,setCurrentScreen:function(e){f.currentScreen&&f.currentScreen.destroy(),f.currentScreen=e}},e.next=12,B(r,"./spriter_animations/hands.scml","box_000");case 12:return l=e.sent,f.spriter=l,e.next=16,Object(s.g)(r,"./assets/audition_asset.atlas");case 16:return p=e.sent,e.next=19,Object(s.g)(r,"./assets/audition-assets_mark.atlas");case 19:return g=e.sent,e.next=22,Object(s.g)(r,"./assets/start_end.atlas");case 22:return w=e.sent,e.next=25,Object(s.h)(r,"./assets/curtain.png");case 25:return m=e.sent,x={auditionAtlas:p,finishAtlas:g,startEndAtlas:w,curtain:m},f.assets=x,e.t0=f,e.next=31,j(f);case 31:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1),r.clearColor(0,0,0,0),v=function(e){r.clear(r.COLOR_BUFFER_BIT),f.currentScreen&&f.currentScreen.update(e)},Object(s.c)(v);case 36:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}},[[33,1,2]]]);
//# sourceMappingURL=main.1ddd9fb0.chunk.js.map