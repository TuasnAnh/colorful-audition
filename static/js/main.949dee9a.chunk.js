(this["webpackJsonpmodern-audition"]=this["webpackJsonpmodern-audition"]||[]).push([[0],{33:function(t,e,n){t.exports=n(70)},35:function(t,e,n){},70:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n.n(i),r=n(3),s=(n(35),n(2)),o=n(23),h=n.n(o),c=n(10),d=function(){var t={};return{init:function(e,n){var i=n.width,a=(n.height,n.assets.auditionAtlas.findRegion("table",-1)),r=i,s=r*a.height/a.width;t={tex:a,w:r,h:s}},update:function(e,n,i){var a=n.boundaryY,r=i.batch,s=i.width,o=(i.height,i.camera);r.setProjection(o.combined),r.begin(),r.setColor(1,1,1,1),t.tex.draw(r,s/2-t.w/2,a,t.w,t.h),r.end()}}},u=function(){var t,e,n,i,a=[],r=[],s={},o=1,h=.4;return{init:function(o,h){var c=h.width,d=h.height,u=h.assets,f=u.auditionAtlas,l=u.finishAtlas,g=f.findRegion("up",-1),p=f.findRegion("down",-1),w=f.findRegion("left",-1),m=f.findRegion("right",-1),x=f.findRegion("up-press",-1),v=f.findRegion("down-press",-1),y=f.findRegion("left-press",-1),b=f.findRegion("right-press",-1),_=f.findRegion("finish_press",-1);e=l.findRegion("finish_start_effect",-1),i=(n=c/8)*e.height/e.width;var R=c/4,j=R*_.height/_.width,S=c/5,P=S*g.height/g.width,k=.8*S,O=(c-(2*S+k))/2,E=3.95*d/5;t=_,s={x:O+S+k/2-R/2,y:E+P/2-j/2,width:R,height:j},a=[{unpress:w,press:y},{unpress:g,press:x},{unpress:m,press:b},{unpress:p,press:v}],r=[{x:O,y:E,width:S,height:P},{x:O+S/2+k/2,y:E-.8*P,width:S,height:P},{x:O+S+k,y:E,width:S,height:P},{x:O+S/2+k/2,y:E+.8*P,width:S,height:P}],o.buttonRect=r,o.finishRect=s},update:function(c,d,u){var f=u.batch,l=u.camera;u.width,u.height,u.whiteTex,u.inputHandler;f.setProjection(l.combined),f.begin(),f.setColor(1,1,1,1),d.finishedPhase&&!d.hitFinishButton?(o=Math.max(.7,o-=2*c),h=Math.min(1,h+=4*c)):d.finishedPhase&&!d.hitFinishButton||(o=Math.min(1,o+=2*c),h=Math.max(.4,h-=4*c)),d.finishedPhase&&(d.starEffect.scale1+=47*c/3,f.setColor(1,1,1,d.starEffect.opacity1),e.draw(f,s.x+s.width/2-n/2,s.y+s.height/2-i/2,n,i,n/2,i/2,0,d.starEffect.scale1,d.starEffect.scale1),f.setColor(1,1,1,1),d.starEffect.scale1>=4&&(d.starEffect.scale2+=47*c/3,f.setColor(1,1,1,d.starEffect.opacity2),e.draw(f,s.x+s.width/2-n/2,s.y+s.height/2-i/2,n,i,n/2,i/2,0,d.starEffect.scale2,d.starEffect.scale2),f.setColor(1,1,1,1)),d.starEffect.scale1=Math.min(6,d.starEffect.scale1),6===d.starEffect.scale1&&(d.starEffect.opacity1=Math.max(0,d.starEffect.opacity1-=5*c)),d.starEffect.scale2=Math.min(6,d.starEffect.scale2),6===d.starEffect.scale2&&(d.starEffect.opacity2=Math.max(0,d.starEffect.opacity2-=5*c)));for(var g=0;g<r.length;g++){(d.keyActivated[g]?a[g].press:a[g].unpress).draw(f,r[g].x,r[g].y,r[g].width,r[g].height,r[g].width/2,r[g].height/2,0,o,o)}t.draw(f,s.x,s.y,s.width,s.height,s.width/2,s.height/2,0,h,h),f.end()}}},f=function(t,e){return e[t]=!0},l=function(t,e){return e[t]=!1},g=function(t,e,n,i){if(t===e[n][i.currentCheckingNoteIndex].type)e[n][i.currentCheckingNoteIndex].activated=!0,i.zoomOutNoteIndexs.push(i.currentCheckingNoteIndex),i.currentCheckingNoteIndex+=1,i.currentCheckingNoteIndex===e[n].length&&(i.currentCheckingNoteIndex=e[n].length-1,i.finishedPhase=!0);else{i.currentCheckingNoteIndex=0;for(var a=0;a<e[n].length;a++)e[n][a].activated=!1}},p=function(){var t,e=new s.a;return{init:function(n,i){i.canvas,i.camera,i.pixelRatio;var a=i.inputHandler,r=n.buttonRect,s=n.notes,o=n.finishRect;a.addEventListener("touchStart",(function(i,h,c){if(!n.runIntro){e.setVector(a.getTouchedWorldCoord());var d=function(t,e,n){for(var i=0;i<4;i++){var a=n[i];if(t>a.x&&t<a.x+a.width&&e>a.y&&e<a.y+a.height)return i}return-1}(e.x,e.y,r);if(d>-1&&!n.finishedPhase)t=d,f(d,n.keyActivated),g(d,s,n.phaseIndex,n);else if(n.finishedPhase){1===function(t,e,n){return t>n.x&&t<n.x+n.width&&e>n.y&&e<n.y+n.height?1:0}(e.x,e.y,o)&&(n.canPassPhase?(n.hit++,n.hitRight=!0):(n.miss++,n.hitMiss=!0),n.disableNode=!0,n.hitFinishButton=!0)}}})),a.addEventListener("touchEnd",(function(e){l(t,n.keyActivated)})),document.addEventListener("keydown",(function(t){n.runIntro||(65===t.which?n.finishedPhase||(f(0,n.keyActivated),g(0,s,n.phaseIndex,n)):87===t.which?n.finishedPhase||(f(1,n.keyActivated),g(1,s,n.phaseIndex,n)):68===t.which?n.finishedPhase||(f(2,n.keyActivated),g(2,s,n.phaseIndex,n)):83===t.which&&(n.finishedPhase||(f(3,n.keyActivated),g(3,s,n.phaseIndex,n))),n.finishedPhase&&32===t.which&&(n.canPassPhase?(n.hit++,n.hitRight=!0):(n.miss++,n.hitMiss=!0),n.disableNode=!0,n.hitFinishButton=!0))})),document.addEventListener("keyup",(function(t){65===t.which?l(0,n.keyActivated):87===t.which?l(1,n.keyActivated):68===t.which?l(2,n.keyActivated):83===t.which&&l(3,n.keyActivated)}))},update:function(){}}},w=function(){var t=[];return{init:function(e,n){var i=n.assets.auditionAtlas,a=i.findRegion("down-btn",-1),r=i.findRegion("up-btn",-1),s=i.findRegion("left-btn",-1),o=i.findRegion("right-btn",-1),h=i.findRegion("down-btn-gray",-1),c=i.findRegion("up-btn-gray",-1),d=i.findRegion("left-btn-gray",-1),u=i.findRegion("right-btn-gray",-1);t=[{active:s,passive:d},{active:r,passive:c},{active:o,passive:u},{active:a,passive:h}]},update:function(e,n,i){for(var a=n.notes,r=n.noteInfos,s=(n.currentCheckingNoteIndex,n.phaseIndex),o=n.zoomOutNoteIndexs,h=n.zoomOutNoteInfos,c=n.runIntro,d=n.hitFinishButton,u=i.batch,f=(i.width,i.height,i.camera),l=r[s],g=a[s],p=0;p<o.length;p++){var w=o[p];h.push({tex:t[g[w].type].passive,scale:2,postion:l[w]}),o.splice(p,1)}if(u.setProjection(f.combined),u.begin(),u.setColor(1,1,1,1),!d&&!c)for(var m=l.length-1;m>=0;m--){var x=l[m];if((!0===g[m].activated?t[g[m].type].active:t[g[m].type].passive).draw(u,x.x,x.y,x.width,x.height),h[m]){h[m].scale-=4*e;var v=h[m],y=v.tex,b=v.postion;u.setColor(1,1,1,.5),y.draw(u,b.x,b.y,b.width,b.height,b.width/2,b.height/2,0,h[m].scale,h[m].scale),u.setColor(1,1,1,1),h[m].scale<=1.1&&h.splice(m,1)}}u.end()}}},m=function(){var t,e,n,i,a,r,o,h,c,d,u,f,l,g,p,w,m={},x={},v={};return{init:function(a,s){var y=a.boundaryY,b=s.assets,_=s.width,R=s.height,j=b.auditionAtlas,S=b.finishAtlas;t=b.finishBar,n=b.mask,e=j.findRegion("finish_mark",-1),i=S.findRegion("finsh_mark_effect",-1),u=S.findRegion("cool",-1),f=S.findRegion("great",-1),l=S.findRegion("perfect",-1),g=S.findRegion("miss",-1),p=[l,f,u,g];var P=R/25,k=P*u.width/u.height,O=R/25,E=O*f.width/f.height,C=R/25,A=C*l.width/l.height,I=R/25,M=I*g.width/g.height;w=[{width:A,height:C},{width:E,height:O},{width:k,height:P},{width:M,height:I}];var N=(r=8.6*_/9)*t.height/t.width,T=(_-r)/2,z=(h=r/30)*e.height/e.width;i=S.findRegion("finsh_mark_effect",-1),d=(c=h)*i.height/i.width;var F=2.5*N/4;x={x:T+.575*r,y:(m={x:T,y:y+R/40,width:r,height:N}).y+N/2-F/2,width:o=r/4,height:F},v={y:m.y+N/2-z/2,width:h,height:z}},update:function(h,u,f){var l=f.width,g=f.height,y=f.batch,b=f.camera,_=u.stateTime,R=u.realTimeDurationSet,j=u.durationEachPhase;if(v.x=m.x+r-(R-_)/j*r,a=o*j/r,R-_<j-.575*j&&R-_>j-.575*j-a&&u.finishedPhase?u.canPassPhase=!0:u.canPassPhase=!1,y.setProjection(b.combined),y.begin(),Object(s.f)(y,t,m.x,m.y,m.width,m.height),y.setColor(1,1,1,.5),Object(s.f)(y,n,x.x,x.y,x.width,x.height),y.setColor(1,1,1,.75),Object(s.f)(y,n,x.x+x.width/5,x.y,3*x.width/5,x.height),y.setColor(1,1,1,1),Object(s.f)(y,n,x.x+2*x.width/5,x.y,x.width/5,x.height),u.hitFinishButton){var S=function(t,e,n,i,a,r,s){var o,h=n-.575*n-i/2,c=i/5;return t-e<h+c/2&&t-e>h-c/2?("perfect",o={tex:r[0],infos:s[0]}):t-e<h-c/2&&t-e>h-3*c/2||t-e<h+3*c/2&&t-e>h+c/2?("great",o={tex:r[1],infos:s[1]}):t-e<h-3*c/2&&t-e>h-5*c/2||t-e<h+5*c/2&&t-e>h+3*c/2?("cool",o={tex:r[2],infos:s[2]}):("miss",o={tex:r[3],infos:s[3]}),o}(R,_,j,a,0,p,w);u.textPopUp.startY=Math.max(1.1*g/3,u.textPopUp.startY-=h*g/3),u.textPopUp.scale=Math.min(1,u.textPopUp.scale+=5*h),u.textPopUp.startY===1.1*g/3&&(u.textPopUp.opacity=Math.max(0,u.textPopUp.opacity-=h)),y.setColor(1,1,1,u.textPopUp.opacity),S.tex.draw(y,l/2-S.infos.width/2,u.textPopUp.startY,S.infos.width,S.infos.height,S.infos.width/2,S.infos.height/2,0,u.textPopUp.scale,u.textPopUp.scale)}u.runIntro||(u.hitFinishButton?(u.finishMarkEffect.scale=Math.min(2.3,u.finishMarkEffect.scale+=10*h),2.3===u.finishMarkEffect.scale&&(u.finishMarkEffect.opacity=Math.max(0,u.finishMarkEffect.opacity-=5*h)),y.setColor(1,1,1,u.finishMarkEffect.opacity),i.draw(y,v.x+v.width/2-c/2-v.width/2,v.y+v.height/2-d/2,c,d,c/2,d/2,0,u.finishMarkEffect.scale,u.finishMarkEffect.scale),y.setColor(1,1,1,1)):v.x<=r+v.width/2&&(u.finishMarkEffect={scale:1,opacity:1},e.draw(y,v.x-v.width/2,v.y,v.width,v.height))),y.end()}}},x=n(4),v=n(0),y=n(9),b=function(){var t,e,n,i,a,r={bam_sai:{x:0,y:3},buom_bay_right:{x:5,y:-3},xoa_tay:{x:-5,y:-5},buom_bay_left:{x:7,y:-3},choang_nhau:{x:7,y:0},tinh_ban:{x:9,y:2},ca_sau:{x:4,y:5}};return{init:function(e,n){var r=n.width,o=n.height,h=n.canvas,c=n.pixelRatio,d=n.spriter,u=Object(s.i)(h,c),f=Object(x.a)(u,2),l=f[0],g=f[1];t=function(t,e,n,i){var a=v.a.create(),r=v.a.create(),s=v.a.create(),o=v.a.create(),h=[0,0],c=[0,0,0],d=[0,0,1],u=[0,0,0],f=[0,1,0],l=function(){v.a.ortho(a,-t/2,t/2,-e/2,e/2,0,1);var n=h[0],i=h[1];d[0]=u[0]=n,d[1]=u[1]=i,v.a.identity(r),v.a.lookAt(o,d,u,f),v.a.mul(r,r,o),v.a.mul(a,a,r),v.a.invert(s,a)};return l(),{combined:a,setMatrix:function(t){v.a.copy(a,t),v.a.invert(s,a)},setYUp:function(t){f[1]=t?-1:1,l()},setPosition:function(t,e){h[0]=t,h[1]=e,l()},unprojectVector2:function(t,e){c[0]=e.x,c[1]=e.y,c[2]=0,Object(y.a)(c,c,s,0,0,n,i),t.set(c[0],c[1])},resize:function(n,i){t=n,e=i,l()}}}(r,o,l,g),i=r,a=a=r/d.getAspect(),d.setEntity("hands")},update:function(s,o,h){var c=h.spriter,d=h.batch,u=h.width,f=h.height;h.pixelRatio;d.setProjection(t.combined),d.begin(),c.setAnim(o.anim),c.update(1e3*s),e=0,n=0;var l=r[c.getAnim()];l&&(e=l.x,n=l.y),c.draw(d,0+e,f/2-a/2+n,1.2*i,1.2*a,u/f),d.end()}}},_=function(){var t={};return{init:function(e,n){var i=n.assets,a=n.width,r=i.curtain,s=a,o=s*r.height/r.width;t={tex:r,w:s,h:o}},update:function(e,n,i){var a=i.camera,r=i.batch;r.setProjection(a.combined),r.begin(),r.setColor(1,1,1,1),Object(s.f)(r,t.tex,0,0,t.w,t.h),r.end()}}},R=function(){var t={};return{init:function(e,n){var i=n.assets,a=n.width,r=i.auditionAtlas.findRegion("bg",-1),s=a,o=s*r.height/r.width;t={tex:r,w:s,h:o}},update:function(e,n,i){var a=i.batch,r=i.camera,s=i.width;a.setProjection(r.combined),a.begin(),a.setColor(1,1,1,1),t.tex.draw(a,s/2-t.w/2,-t.h/30,t.w,t.h),a.end()}}},j=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=t.x*n,a=t.y*n,r=e[0],s=e[0]+e[2],o=e[1],h=e[1]+e[3];return!(i<r||i>s||a<o||a>h)},S=function(t){var e=function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,V(t);case 3:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n=t.batch,i=t.canvas,o=t.width,h=t.height,c=t.camera,d=t.viewport,u=t.assets,f=Object(s.e)(i,d),l=u.auditionAtlas,g=u.startEndAtlas,p=l.findRegion("table",-1),w=o,m=w*p.height/p.width,x=l.findRegion("bg",-1),v=o,y=v*x.height/x.width,b=u.curtain,_=o,R=_*b.height/b.width,S=g.findRegion("restart_button",-1),P=g.findRegion("quote",-1),k=g.findRegion("your_score",-1),O=g.findRegion("percentage",-1),E=o/4.5,C=E*S.height/S.width,A=o/2-E/2,I=2.3*h/3,M=[A,I,E,C],N=.95*o,T=N*P.height/P.width,z=o/1.8,F=z*k.height/k.width,B=g.findRegion("0_end",-1),U=g.findRegion("1_end",-1),D=g.findRegion("2_end",-1),Y=g.findRegion("3_end",-1),J=g.findRegion("4_end",-1),L=g.findRegion("5_end",-1),W=g.findRegion("6_end",-1),X=g.findRegion("7_end",-1),H=g.findRegion("8_end",-1),q=g.findRegion("9_end",-1),$=h/8,Z=[{tex:B,width:$*B.width/B.height},{tex:U,width:$*U.width/U.height},{tex:D,width:$*D.width/D.height},{tex:Y,width:$*Y.width/Y.height},{tex:J,width:$*J.width/J.height},{tex:L,width:$*L.width/L.height},{tex:W,width:$*W.width/W.height},{tex:X,width:$*X.width/X.height},{tex:H,width:$*H.width/H.height},{tex:q,width:$*q.width/q.height}],G={tex:O,width:$*O.width/O.height},K=function(t,e,n,i){for(var a=0,r=[],s=0;s<t.length;s++)a+=e[s].width;for(var o=n/2-(a+=i.width)/2,h=0,c=0;c<t.length;c++){h+=e[c-1]?e[c-1].width:0,r.push({tex:e[t[c]].tex,x:o+h,width:e[c].width})}return h+=e[e.length-1].width,r.push({tex:i.tex,x:o+h,width:i.width}),r}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t.charAt(n);e.push(parseInt(i))}return e}(t.completePercentage.toString()),Z,o,G);f.addEventListener("touchStart",(function(n,i){var a=f.getTouchedWorldCoord();j({x:a.x,y:a.y},M)&&(t.completePercentage=0,e())}));return{update:function(t){n.setProjection(c.combined),n.begin(),n.setColor(1,1,1,1),x.draw(n,o/2-v/2,-y/30,v,y),p.draw(n,o/2-w/2,h/2-h/20,w,m),Object(s.f)(n,b,0,0,_,R),S.draw(n,A,I,E,C),P.draw(n,o/2-N/2,h/2,N,T),k.draw(n,o/2-z/2,h/4,z,F);for(var e=0;e<K.length;e++)K[e].tex.draw(n,K[e].x,h/3,K[e].width,$);n.end()},destroy:function(){f.cleanup()}}},P=function(t){for(var e=t.canvas,n=t.width,i=t.height,o=t.gl,h=t.batch,f=t.whiteTex,l=t.camera,g=t.pixelRatio,x=t.assets,v=t.spriter,y=t.viewport,j=t.sound,P=Object(s.e)(e,y),k="0,4,0,0,dance\n4,8,5,8,buom_bay_right\n13,7.5,6,7.5,xoa_tay\n23,5,4,6.5,buom_bay_left\n30,6,5,4,tinh_ban\n37,3.5,3,3,ca_sau\n42,3.5,4,2.5,buom_bay_right\n47,3.5,5,3,xoa_tay,\n52,7,8,2.975,buom_bay_left".split("\n"),O=[],E=0;E<k.length;E++){var C=k[E].split(",").map((function(t){return t.trim()}));O.push({start:parseFloat(C[0]),duration:parseFloat(C[1]),nodes:parseFloat(C[2]),dancingDuration:parseFloat(C[3]),anim:C[4]})}var A=O[0];O.shift(),j.play();for(var I=[],M=0;M<O.length;M++)I.push(O[M].nodes);for(var N=[],T=0,z=I;T<z.length;T++){for(var F=z[T],B=[],U=0;U<F;U++)B.push({type:Math.floor(4*Math.random()),activated:!1});N.push(B)}for(var V=n/7,D=n/100,Y=i/2+i/30,J=[],L=0;L<N.length;L++){for(var W=[],X=0,H=0,q=0,$=0;$<N[L].length;$++){var Z=0;$<=3?(q=N[L].length,H=(n-D*(Math.min(4,q)-1)-V*Math.min(4,q))/2,X=Y,Z=$):(H=(n-D*((q=N[L].length-4)-1)-V*q)/2,X=Y+i/14,Z=Math.abs(4-$)),W.push({x:H+(V+D)*Z,y:X,width:V,height:V})}J.push(W)}var G={runIntro:!1,hit:0,miss:0,anim:"",missAnim:"bam_sai",animIndex:-1,stateTime:0,keyActivated:[],boundaryY:i/2-i/20,gameOver:!1,buttonInfos:null,durationBarInfos:{duration:4,x:(n-4*n/5)/2,y:3*i/4,width:4*n/5,height:i/10},notes:N,noteInfos:J,currentCheckingNoteIndex:0,phaseIndex:-1,durationEachPhase:4,realTimeDurationSet:4,hitRight:!1,hitMiss:!1,canPassPhase:!1,finishedPhase:!1,zoomOutNoteIndexs:[],zoomOutNoteInfos:[],hitFinishButton:!1,starEffect:{scale1:1,opacity1:1,scale2:1,opacity2:1},finishMarkEffect:{scale:1,opacity:1},textPopUp:{opacity:1,scale:.5,startY:1.3*i/3}},K=function(t,e){var n=[],i=[];return{addSystem:function(a){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];a.init&&a.init(t,e),r?i.push(a):n.push(a)},update:function(a){var r,s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object(c.a)(n);try{for(o.s();!(r=o.n()).done;){var h=r.value;h.update(a,t,e)}}catch(l){o.e(l)}finally{o.f()}if(s){var d,u=Object(c.a)(i);try{for(u.s();!(d=u.n()).done;){var f=d.value;f.update(a,t,e)}}catch(l){u.e(l)}finally{u.f()}}}}}(G,{canvas:e,width:n,height:i,gl:o,batch:h,whiteTex:f,camera:l,pixelRatio:g,assets:x,spriter:v,inputHandler:P});K.addSystem(R()),K.addSystem(b()),K.addSystem(d()),K.addSystem(_()),K.addSystem(u()),K.addSystem(p()),K.addSystem(m()),K.addSystem(w());var Q=function(){var e=Object(r.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,S(t);case 3:e.t1=e.sent,e.t0.setCurrentScreen.call(e.t0,e.t1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),tt=0,et=-1,nt=0,it=!0,at=!1;return{update:function(e){(tt+=e)>A.start&&tt<=A.start+A.duration?(G.anim="bam_sai",G.runIntro=!0):(G.runIntro=!1,G.hitFinishButton||(G.stateTime+=e),void 0!==O[et+1]&&(tt>O[et+1].start&&(it=!0),tt>O[et+1].start&&it&&(it=!1,at=!0,et=Math.min(et+=1,O.length))),tt>O[O.length-1].start+O[O.length-1].duration&&(t.completePercentage=Math.floor(G.hit/O.length*100),Q()),tt>O[et].start&&at&&(at=!1,G.starEffect={scale1:1,scale2:1,opacity1:1,opacity2:1},G.textPopUp={opacity:1,scale:.5,startY:1.3*i/3},G.hitFinishButton=!1,G.hitRight=!1,G.finishedPhase=!1,G.canPassPhase=!1,G.zoomOutNoteIndexs.length=0,G.zoomOutNoteInfos.length=0,G.durationEachPhase=O[et].duration,G.realTimeDurationSet=G.stateTime+G.durationEachPhase,G.currentCheckingNoteIndex=0,G.phaseIndex+=1,G.phaseIndex=G.phaseIndex>I.length-1?I.length-1:G.phaseIndex),tt<O[nt].start+O[nt].duration+O[nt].dancingDuration?G.hitMiss?G.anim="bam_sai":G.hitRight&&(nt<et&&(nt=et),G.anim=O[nt].anim):(nt=Math.min(nt+=1,O.length),G.hitMiss=!1,G.anim="bam_sai")),h.setProjection(l.combined),K.update(e)},destroy:function(){P.cleanup()}}},k=function(t,e){var n={toObj:function(t){var e={};if(1===t.nodeType){if(t.attributes.length)for(var i=0;i<t.attributes.length;i++)e["@"+t.attributes[i].nodeName]=(t.attributes[i].nodeValue||"").toString();if(t.firstChild){for(var a=0,r=0,s=!1,o=t.firstChild;o;o=o.nextSibling)1===o.nodeType?s=!0:3===o.nodeType&&o.nodeValue.match(/[^ \f\n\r\t\v]/)?a++:4===o.nodeType&&r++;if(s)if(a<2&&r<2){n.removeWhite(t);for(var h=t.firstChild;h;h=h.nextSibling)3===h.nodeType?e["#text"]=n.escape(h.nodeValue):4===h.nodeType?e["#cdata"]=n.escape(h.nodeValue):e[h.nodeName]?e[h.nodeName]instanceof Array?e[h.nodeName][e[h.nodeName].length]=n.toObj(h):e[h.nodeName]=[e[h.nodeName],n.toObj(h)]:e[h.nodeName]=n.toObj(h)}else t.attributes.length?e["#text"]=n.escape(n.innerXml(t)):e=n.escape(n.innerXml(t));else if(a)t.attributes.length?e["#text"]=n.escape(n.innerXml(t)):e=n.escape(n.innerXml(t));else if(r)if(r>1)e=n.escape(n.innerXml(t));else for(var c=t.firstChild;c;c=c.nextSibling)e["#cdata"]=n.escape(c.nodeValue)}t.attributes.length||t.firstChild||(e=null)}else 9===t.nodeType?e=n.toObj(t.documentElement):alert("unhandled node type: "+t.nodeType);return e},toJson:function(t,e,i){var a=e?'"'+e+'"':"";if(t instanceof Array){for(var r=0,s=t.length;r<s;r++)t[r]=n.toJson(t[r],"",i+"\t");a+=(e?":[":"[")+(t.length>1?"\n"+i+"\t"+t.join(",\n"+i+"\t")+"\n"+i:t.join(""))+"]"}else if(null==t)a+=(e&&":")+"null";else if("object"==typeof t){var o=[];for(var h in t)o[o.length]=n.toJson(t[h],h,i+"\t");a+=(e?":{":"{")+(o.length>1?"\n"+i+"\t"+o.join(",\n"+i+"\t")+"\n"+i:o.join(""))+"}"}else a+="string"==typeof t?(e&&":")+'"'+t.toString()+'"':(e&&":")+t.toString();return a},innerXml:function(t){var e="";if("innerHTML"in t)e=t.innerHTML;else for(var n=function t(e){var n="";if(1===e.nodeType){n+="<"+e.nodeName;for(var i=0;i<e.attributes.length;i++)n+=" "+e.attributes[i].nodeName+'="'+(e.attributes[i].nodeValue||"").toString()+'"';if(e.firstChild){n+=">";for(var a=e.firstChild;a;a=a.nextSibling)n+=t(a);n+="</"+e.nodeName+">"}else n+="/>"}else 3===e.nodeType?n+=e.nodeValue:4===e.nodeType&&(n+="<![CDATA["+e.nodeValue+"]]>");return n},i=t.firstChild;i;i=i.nextSibling)e+=n(i);return e},escape:function(t){return t.replace(/[\\]/g,"\\\\").replace(/[\\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(t){t.normalize();for(var e=t.firstChild;e;)if(3===e.nodeType)if(e.nodeValue.match(/[^ \f\n\r\t\v]/))e=e.nextSibling;else{var i=e.nextSibling;t.removeChild(e),e=i}else 1===e.nodeType?(n.removeWhite(e),e=e.nextSibling):e=e.nextSibling;return t}};9===t.nodeType&&(t=t.documentElement);var i=n.toJson(n.toObj(n.removeWhite(t)),t.nodeName,"\t");return"{\n"+e+(e?i.replace(/\t/g,e):i.replace(/\t|\n/g,""))+"\n}"},O=n(16),E=function(){var t=Object(r.a)(a.a.mark((function t(e){var n,i,r,s,o,h,c,d,u,f;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={},i=null,t.next=4,fetch(e).then((function(t){return t.text()}));case 4:return s=t.sent,null!==e.match(/.scml$/i)?(o=new DOMParser,h=s.replace(/&quot;/g,'"'),c=o.parseFromString(h,"text/xml"),d=(d=k(c,"\t")).replace(/"@(.*)":/g,'"$1":'),u=JSON.parse(d),r=u.spriter_data):r=JSON.parse(s),(i=(new O.Data).load(r)).folder_array.forEach((function(t,e){n[e]={},t.file_array.forEach((function(e,i){n[t.id][i]=e.name}))})),f=new O.Pose(i),t.abrupt("return",{regionNames:n,pose:f,data:i,rawData:r});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=n(7),A=n(5),I=function(){function t(e,n,i,a,r,s,o,h,c,d){Object(C.a)(this,t),c&&d||(c=1/e.width,d=1/e.height);var u=n*c,f=i*d,l=(n+a)*c,g=(i+r)*d;for(var p in this.rotated=!1,this.texture=e,this.x=n,this.y=i,this.originX=s,this.originY=o,this.width=a,this.height=r,this.u=u,this.v=f,this.u2=l,this.v2=g,h)this[p]=h[p]}return Object(A.a)(t,null,[{key:"splitTexture",value:function(e,n,i){for(var a=e.width/n,r=e.height/i,s=[],o=0;o<n;o++)for(var h=0;h<i;h++)s.push(new t(e,o*a,h*r,a,r,{}));return s}}]),Object(A.a)(t,[{key:"draw",value:function(t,e,n,i,a){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1;t.draw(this.texture,e,n,i,a,this.rotated,r,s,o,h,c,this.u,this.v,this.u2,this.v2)}}]),t}();function M(t,e){for(var n=t.split("/"),i=e.split("/"),a=[],r=0,s=n.length;r<s;r++)if(".."===n[r])a.pop();else{if("."===n[r])continue;a.push(n[r])}for(var o=0,h=i.length;o<h;o++)if(".."===i[o])a.pop();else{if("."===i[o])continue;a.push(i[o])}return a.join("/")}var N=function(){var t=Object(r.a)(a.a.mark((function t(e,n,i,r){var o,h,c,d,u,f,l,g,p,w,m,x,v,y,b,_,R,j,S,P,k,O,E,C,A,N,T;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n).then((function(t){return t.text()}));case 2:for(o=t.sent,h=[],c=[],d=JSON.parse(o),u=d.meta,f=Object.getOwnPropertyNames(d.frames),l=Object.keys(d.frames).map((function(t){return d.frames[t]})),g=M(n,"../".concat(u.image)),p=0;p<l.length;p++)w=l[p],m=w.frame.w,x=w.frame.h,v={x:w.frame.x,y:w.frame.y,w:w.frame.w,h:w.frame.h,rotate:w.rotated?1:0,offset_x:w.spriteSourceSize&&w.spriteSourceSize.x||0,offset_y:w.spriteSourceSize&&w.spriteSourceSize.y||0,original_w:w.sourceSize&&w.sourceSize.w||m,original_h:w.sourceSize&&w.sourceSize.h||x},c.push(v),y={id:p,name:f[p],frame:w.frame,rotated:"true"===w.rotated,sourceSize:w.sourceSize,spriteSourceSize:w.spriteSourceSize,trimmed:w.trimmed,app:u.app,format:u.format,main_texture:u.image,scale:u.scale,size:u.size,version:u.version,site:v,meta:u},h.push(y);return t.next=13,Object(s.h)(e,g,i);case 13:for(b=t.sent,_=0,R=h;_<R.length;_++)j=R[_],S=j.frame.x,P=j.frame.y,k=j.rotated?j.frame.h:j.frame.w,O=j.rotated?j.frame.w:j.frame.h,E=j.rotated?j.sourceSize.h:j.sourceSize.w,C=j.rotated?j.sourceSize.w:j.sourceSize.h,A=j,N=1/j.size.w,T=1/j.size.h,r.push(new I(b,S,P,k,O,E,C,A,N,T));return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})));return function(e,n,i,a){return t.apply(this,arguments)}}(),T=function(){var t=Object(r.a)(a.a.mark((function t(e,n,i){var r,s,o,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=[],!Array.isArray(n)){t.next=22;break}s=Object(c.a)(n),t.prev=3,s.s();case 5:if((o=s.n()).done){t.next=12;break}return h=o.value,t.next=9,N(e,h,i,r);case 9:r=t.sent;case 10:t.next=5;break;case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(3),s.e(t.t0);case 17:return t.prev=17,s.f(),t.finish(17);case 20:t.next=25;break;case 22:return t.next=24,N(e,n,i,r);case 24:r=t.sent;case 25:return t.abrupt("return",{getRegions:function(){return r},findRegion:function(t){for(var e=0;e<r.length;e++)if(r[e].name===t)return r[e]}});case 26:case"end":return t.stop()}}),t,null,[[3,14,17,20]])})));return function(e,n,i){return t.apply(this,arguments)}}(),z=n(24),F=n.n(z);function B(t,e){for(var n=t.split("/"),i=e.split("/"),a=[],r=0,s=n.length;r<s;r++)".."===n[r]?a.pop():a.push(n[r]);for(var o=0,h=i.length;o<h;o++)if(".."===i[o])a.pop();else{if("."===i[o])continue;a.push(i[o])}return a.join("/")}var U=function(){var t=Object(r.a)(a.a.mark((function t(e,n,i){var r,s,o,h,c,d,u,f,l,g,p,w,m,x,y,b,_,R,j,S,P,k,O,C,A,I,M,N;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(n);case 2:return r=t.sent,s=r.regionNames,o=r.pose,h=r.data,c=r.rawData,d=c.atlas.i,u=v.a.create(),f=new Float32Array(20),l=[],g=[],p=[],w=[],m=[],x=[],y=[],b=[],t.next=20,T(e,d.map((function(t){return B(n,"../".concat(t.name))})));case 20:return _=t.sent,j=function(t,e,n,i,a,r){t.length=0,t.push(e,n,i,a,r)},S=function(t,e,n,i,a,r){t.rotated?(j(l,e.x-t.height/2,e.y-t.width/2,r,t.u,t.v),j(g,e.x+t.height/2,e.y-t.width/2,r,t.u,t.v2),j(p,e.x+t.height/2,e.y+t.width/2,r,t.u2,t.v2),j(w,e.x-t.height/2,e.y+t.width/2,r,t.u2,t.v)):(j(l,e.x-t.width/2,e.y-t.height/2,r,t.u,t.v2),j(g,e.x+t.width/2,e.y-t.height/2,r,t.u2,t.v2),j(p,e.x+t.width/2,e.y+t.height/2,r,t.u2,t.v),j(w,e.x-t.width/2,e.y+t.height/2,r,t.u,t.v)),v.a.identity(u),v.a.translate(u,u,[e.x,e.y,0]),v.a.rotateZ(u,u,n.rad),v.a.scale(u,u,[i.x,i.y,1]),v.a.translate(u,u,[-e.x,-e.y,0]),j(m,l[0],l[1],0),j(x,g[0],g[1],0),j(y,p[0],p[1],0),j(b,w[0],w[1],0),v.b.transformMat4(m,m,u),v.b.transformMat4(x,x,u),v.b.transformMat4(y,y,u),v.b.transformMat4(b,b,u),a&&(m=a.transform(m),x=a.transform(x),y=a.transform(y),b=a.transform(b)),f[0]=m[0],f[1]=m[1],f[2]=l[2],f[3]=l[3],f[4]=l[4],f[5]=x[0],f[6]=x[1],f[7]=g[2],f[8]=g[3],f[9]=g[4],f[10]=y[0],f[11]=y[1],f[12]=p[2],f[13]=p[3],f[14]=p[4],f[15]=b[0],f[16]=b[1],f[17]=w[2],f[18]=w[3],f[19]=w[4]},k=[[0,0],[0,0],[0,0]],O=[[0,0],[0,0],[0,0]],t.abrupt("return",{getAnim:function(){return o.getAnim()},getInfos:function(){return{regionNames:s,pose:o,data:h,rawData:c}},getAspect:function(){return R?R.w/R.h:1},update:function(t){o.update(t),o.strike()},setEntity:function(t){o.setEntity(t);var e=o.data.entity_map[t];R=e.obj_info_map[i],N=null},setAnim:function(t){o.setAnim(t),N=null},draw:function(t,e,n,a,r){if(!P){var h=(P=o.object_array.find((function(t){return t.name===i}))).world_space.position.x,c=P.world_space.position.y,d=R.w*P.world_space.scale.x,u=R.h*P.world_space.scale.y;j(k[0],h-d/2,c-u/2),j(k[1],h+d/2,c-u/2),j(k[2],h-d/2,c+u/2)}N&&e===C&&n===A&&a===I&&r===M||(j(O[0],e-a/2,n-r/2),j(O[1],e+a/2,n-r/2),j(O[2],e-a/2,n+r/2),C=e,A=n,I=a,M=r,N=F.a.estimate("TS",k,O)),o.object_array.forEach((function(e){if("sprite"===e.type){var n=e.world_space,i=n.position,a=n.rotation,r=n.scale;if(s[e.folder_index]&&s[e.folder_index][e.file_index]){var o=_.findRegion(s[e.folder_index][e.file_index]);o&&(S(o,i,a,r,N,t.color),t.drawVertices(o.texture,f,0))}}}))}});case 26:case"end":return t.stop()}}),t)})));return function(e,n,i){return t.apply(this,arguments)}}(),V=function(){var t=Object(r.a)(a.a.mark((function t(e){var n,i,o,h,c,d,u,f,l,g,p,w,m,x,v,y,b,_,R,S,k,O,E,C,A,I,M,N,T,z,F,B,V,D,Y,J,L,W,X,H,q,$,Z,G;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.batch,i=e.canvas,o=e.width,h=e.height,c=e.camera,d=e.viewport,u=e.assets,f=e.gl,t.next=3,U(f,"./spriter_animations/hands.scml","box_000");case 3:return l=t.sent,e.spriter=l,g=Object(s.e)(i,d),p=u.auditionAtlas,w=u.startEndAtlas,m=p.findRegion("table",-1),v=(x=o)*m.height/m.width,y=p.findRegion("bg",-1),_=(b=o)*y.height/y.width,R=u.curtain,k=(S=o)*R.height/R.width,O=w.findRegion("number1_start",-1),E=w.findRegion("number2_Start",-1),C=w.findRegion("number3_start",-1),A=w.findRegion("start_button"),M=(I=o/2)*A.height/A.width,N=[o/2-I/2,2.3*h/3,I,M],z=(T=h/7)*O.width/O.height,B=(F=h/7)*E.width/E.height,V=h/7,D=T*C.width/C.height,Y=!1,J=0,L=0,W=0,X=0,H=function(){var t=Object(r.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,P(e);case 3:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),g.addEventListener("touchStart",(function(t,e){var n=g.getTouchedWorldCoord();j({x:n.x,y:n.y},N)&&(Y=!0)})),q=[1.1,.9,1.05,.95,1,1,1,1,1],$=[0,0,0],Z=["bigger","bigger","bigger"],G=function(t){var e,i,a;(c.setPosition(0,0),n.setProjection(c.combined),n.begin(),n.setColor(1,1,1,1),y.draw(n,o/2-b/2,-_/30,b,_),m.draw(n,o/2-x/2,h/2-h/20,x,v),Object(s.f)(n,R,0,0,S,k),A.draw(n,N[0],N[1],N[2],N[3]),Y&&J<3)&&(J<1?(e=C,i=[D,V],"bigger"===Z[0]?X+=1.5*t:X-=1.5*t,X>=q[$[0]]&&"bigger"===Z[0]&&(Z[0]="smaller",$[0]++),X<=q[$[0]]&&"smaller"===Z[0]&&(Z[0]="bigger",$[0]++),a=X):J>1&&J<2?(e=E,i=[B,F],"bigger"===Z[1]?W+=1.5*t:W-=1.5*t,W>=q[$[1]]&&"bigger"===Z[1]&&(Z[1]="smaller",$[1]++),W<=q[$[1]]&&"smaller"===Z[1]&&(Z[1]="bigger",$[1]++),a=W):J>2&&J<3&&(e=O,i=[z,T],"bigger"===Z[2]?L+=1.5*t:L-=1.5*t,L>=q[$[2]]&&"bigger"===Z[2]&&(Z[2]="smaller",$[2]++),L<=q[$[2]]&&"smaller"===Z[2]&&(Z[2]="bigger",$[2]++),a=L),J+=t,e.draw(n,o/2-i[0]/2,1*h/5,i[0],i[1],i[0]/2,i[1]/2,0,a,a));J>=3&&H(),n.end()},t.abrupt("return",{update:G,destroy:function(){g.cleanup()}});case 44:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=n(25);(function(){var t=Object(r.a)(a.a.mark((function t(){var e,n,i,r,o,c,d,u,f,l,g,p,w,m,x,v,y;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=document.getElementById("main"),n=window.devicePixelRatio,47,100,i=Object(s.d)(e,47,100),r=i.getContext(),o=i.getCamera(),c=Object(s.b)(r),d=h()(r),u=new D.Howl({src:["ghen_covy.mp3"]}),f={completePercentage:0,viewport:i,canvas:e,width:47,height:100,gl:r,batch:c,whiteTex:d,camera:o,pixelRatio:n,sound:u,setCurrentScreen:function(t){f.currentScreen&&f.currentScreen.destroy(),f.currentScreen=t}},t.next=12,Object(s.g)(r,"./assets/audition_asset.atlas");case 12:return l=t.sent,t.next=15,Object(s.g)(r,"./assets/audition-assets_mark.atlas");case 15:return g=t.sent,t.next=18,Object(s.g)(r,"./assets/start_end.atlas");case 18:return p=t.sent,t.next=21,Object(s.h)(r,"./assets/curtain.png");case 21:return w=t.sent,t.next=24,Object(s.h)(r,"./assets/finish-bar.png");case 24:return m=t.sent,t.next=27,Object(s.h)(r,"./assets/perfect_mask.png");case 27:return x=t.sent,v={auditionAtlas:l,finishAtlas:g,startEndAtlas:p,curtain:w,finishBar:m,mask:x},f.assets=v,t.t0=f,t.next=33,V(f);case 33:t.t1=t.sent,t.t0.setCurrentScreen.call(t.t0,t.t1),r.clearColor(0,0,0,0),y=function(t){r.clear(r.COLOR_BUFFER_BIT),f.currentScreen&&f.currentScreen.update(t)},Object(s.c)(y);case 38:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}},[[33,1,2]]]);
//# sourceMappingURL=main.949dee9a.chunk.js.map